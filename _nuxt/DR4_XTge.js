import{A as W,c as B,I as x,B as y,e as h,w as m,C as I,D as M,ao as R,T as j,c9 as D,z as U,bf as V,r as N,ac as F,d as $,g as f,E as r,aq as H,ca as X,f as L,n as T,cb as G,cc as O,F as J,af as q,k as K,cd as Q,p as Y,m as Z}from"./J1vHfO4d.js";import{u as ee,f as te,o as ne,q as w,t as C,w as oe,M as b}from"./Yl8EcJLs.js";function ae(i){const e=new WeakMap,g=ee();function v(n){if(i.mode!=="popLayout")return;const a=n.element,l=a.offsetParent,c=l instanceof HTMLElement&&l.offsetWidth||0,s={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};s.right=c-s.width-s.left;const o=i.anchorX==="left"?`left: ${s.left}`:`right: ${s.right}`;n.element.dataset.motionPopId=n.id;const t=document.createElement("style");g.value.nonce&&(t.nonce=g.value.nonce),e.set(n,t),document.head.appendChild(t),t.sheet&&t.sheet.insertRule(`
    [data-motion-pop-id="${n.id}"] {
      position: absolute !important;
      width: ${s.width}px !important;
      height: ${s.height}px !important;
      top: ${s.top}px !important;
      ${o}px !important;
      }
      `)}function p(n){const a=e.get(n);a&&(e.delete(n),te.render(()=>{document.head.removeChild(a)}))}return{addPopStyle:v,removePopStyle:p,styles:e}}function A(i){return Promise.resolve().then(()=>{i()})}const se=W({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(i){const e=i;ne(e);const{addPopStyle:g,removePopStyle:v,styles:p}=ae(e);function n(o){let t=o;for(;t;){if(w.get(t))return t;t=t.firstElementChild}return null}function a(o){const t=w.get(o);t&&(v(t),t.isVShow=!0,C(o),A(()=>{t.setActive("exit",!1)}))}const l=new Map;B(()=>{l.clear()});function c(o,t){var _;const d=n(o),u=w.get(d);if(!d||!u){t(),l.size===0&&((_=e.onExitComplete)==null||_.call(e));return}l.set(d,!0),C(d),g(u);function P(S){var k,E;if((k=S?.detail)!=null&&k.isExit){const z=u.visualElement.projection;if(z?.animationProgress>0&&!u.isSafeToRemove&&!u.isVShow)return;C(d),l.delete(d),l.size===0&&((E=e.onExitComplete)==null||E.call(e)),p.has(u)?v(u):u.willUpdate("done"),t(),d.isConnected||u.unmount(!0)}}A(()=>{u.setActive("exit",!0),oe.set(d,P),d.addEventListener("motioncomplete",P)})}const s=x(()=>e.mode!=="wait"?{tag:e.as}:{mode:e.mode==="wait"?"out-in":void 0});return(o,t)=>(h(),y(R(o.mode==="wait"?j:D),M({css:!1},s.value,{appear:"",onEnter:a,onLeave:c}),{default:m(()=>[I(o.$slots,"default")]),_:3},16))}}),ie={slots:{base:"rounded-md",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none p-4 sm:p-8"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},le=["onClick"],ce=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(i){const e=i,g=U(),[v,p]=V(),n=N(!1),a=x(()=>q({extend:q(ie),...g.uiPro?.prose?.img||{}})({zoom:e.zoom,open:n.value})),l=x(()=>{if(e.src?.startsWith("/")&&!e.src.startsWith("//")){const c=K(Q(Y().app.baseURL));if(c!=="/"&&!e.src.startsWith(c))return Z(c,e.src)}return e.src});return e.zoom&&F(window,"scroll",()=>{n.value=!1}),(c,s)=>(h(),$(J,null,[f(r(v),null,{default:m(()=>[(h(),y(R(r(H)),M({src:l.value,alt:i.alt,width:i.width,height:i.height},c.$attrs,{class:a.value.base({class:[e.ui?.base,e.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),i.zoom?(h(),y(r(O),{key:0,open:n.value,"onUpdate:open":s[0]||(s[0]=o=>n.value=o),modal:!1},{default:m(({close:o})=>[f(r(X),{"as-child":""},{default:m(()=>[f(r(b),{"layout-id":l.value,"as-child":"",transition:{type:"spring",bounce:.2,duration:.4}},{default:m(()=>[f(r(p))]),_:1},8,["layout-id"])]),_:1}),f(r(G),null,{default:m(()=>[f(r(se),null,{default:m(()=>[n.value?(h(),y(r(b),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:T(a.value.overlay({class:[e.ui?.overlay]}))},null,8,["class"])):L("",!0),n.value?(h(),$("div",{key:1,class:T(a.value.content({class:[e.ui?.content]})),onClick:o},[f(r(b),{"as-child":"","layout-id":l.value,transition:{type:"spring",bounce:.2,duration:.4}},{default:m(()=>[f(r(p))]),_:1},8,["layout-id"])],10,le)):L("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(h(),y(r(p),{key:1}))],64))}});export{ce as default};
